{{!-- Helper function to handle status codes --}}
{{#*inline "statusExit"}}
    {{#when Response.statuscode 'eq' code}}
        <Exit path="{{path}}" state="{{state}}" code="{{code}}" {{#when Response.isEmpty 'eq' "true"}}empty="true"{{/when}} />
    {{/when}}
{{/inline}}

<Configuration
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../FrankConfig.xsd"
>
    <Adapter name="{{name}}" description="{{description}}">
        <Receiver name="{{receiver.name}}">
            <ApiListener name="{{apiListener.name}}" method="{{apiListener.method}}"
                         uriPattern="{{apiListener.uriPattern}}" produces="{{apiListener.produces}}"/>
        </Receiver>
        <Pipeline>
            <Exits>
                {{#each exits}}
                    {{#with this as |Response|}}
                        {{!-- Success Status Codes --}}
                        {{> statusExit code="200" path="Success" state="SUCCESS"}}
                        {{> statusExit code="201" path="Created" state="SUCCESS"}}
                        {{> statusExit code="202" path="Accepted" state="SUCCESS"}}
                        {{> statusExit code="204" path="NoContent" state="SUCCESS"}}
                        {{> statusExit code="301" path="MovedPermanently" state="SUCCESS"}}
                        {{> statusExit code="304" path="NotModified" state="SUCCESS"}}

                        {{!-- Error Status Codes --}}
                        {{> statusExit code="400" path="BadRequest" state="ERROR"}}
                        {{> statusExit code="401" path="NotAuthorized" state="ERROR"}}
                        {{> statusExit code="403" path="NotAllowed" state="ERROR"}}
                        {{> statusExit code="412" path="PreconditionFailed" state="ERROR"}}
                        {{> statusExit code="500" path="ServerError" state="ERROR"}}
                        {{> statusExit code="504" path="Timeout" state="ERROR"}}
                    {{/with}}
                {{/each}}
            </Exits>

            <!-- <Enter your code here> -->

            {{#if adapterRefs.root}}
            <Json2XmlInputValidator
                    schema="{{adapterRefs.schema}}"
                    root="{{adapterRefs.root}}"
                    {{#if adapterRefs.responseRoot}}responseRoot="{{adapterRefs.responseRoot}}"{{/if}}
                    deepSearch="false">
                {{#each parameters}}<Param name="{{this}}" sessionKey="{{this}}"/>{{/each}}

                    {{#if forwards.success}}<Forward name="success" path="Build_query"/>{{/if}}
                    {{#if forwards.parserError}}<Forward name="parserError" path="NotWellFormed"/>{{/if}}
                    {{#if forwards.illegalRoot}}<Forward name="illegalRoot" path="IllegalRoot"/>{{/if}}
                    {{#if forwards.failure}}<Forward name="failure" path="InvalidXml"/>{{/if}}
                </Json2XmlInputValidator>
            {{/if}}
        </Pipeline>
    </Adapter>
</Configuration>


